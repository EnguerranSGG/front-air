---
let latestNews = null;

try {
  const res = await fetch(`${import.meta.env.PUBLIC_API_URL}/news/latest`);
  const data = await res.json();
  latestNews = data;
} catch (err) {
  console.error("Erreur lors du fetch de la dernière actualité :", err);
}
---
<h2>Notre dernière actualité</h2>
{latestNews && (
  <section class="latest-news-section">
    <div class="news-container">
      <img
        class="news-image"
        src={`${import.meta.env.PUBLIC_ASSET_URL}/files/${latestNews.file?.file_id}/download`}
        alt={latestNews.name}
      />
      <div class="news-content">
        <h3 class="news-title">{latestNews.name}</h3>
        <p class="news-description">{latestNews.description}</p>
        {latestNews.link && (
          <a
            href={latestNews.link}
            target="_blank"
            rel="noopener noreferrer"
            class="news-link"
          >
            En savoir plus
          </a>
        )}
      </div>
    </div>
  </section>
)}
