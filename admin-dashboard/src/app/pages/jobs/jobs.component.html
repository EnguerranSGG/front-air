<h2>Jobs</h2>

<!-- Filtre par position -->
<label for="positionFilter">Filtrer par poste :</label>
<select (change)="onPositionFilterChange($event)">
  <option value="">Tous les jobs</option>
  <option *ngFor="let pos of positions" [value]="pos.position_id">
    {{ pos.name }}
  </option>
</select>

<!-- Formulaire de création -->
<form [formGroup]="createForm" (ngSubmit)="addJob()">
  <input formControlName="function" placeholder="Fonction" required />
  <select formControlName="position_id" required>
    <option [value]="null" disabled>Choisir un poste</option>
    <option *ngFor="let pos of positions" [value]="pos.position_id">
      {{ pos.name }}
    </option>
  </select>
  <button type="submit">Ajouter</button>
</form>

<!-- Liste des jobs -->
<ul>
  <li *ngFor="let job of filteredJobs">
    <div *ngIf="editingId !== job.job_id">
      <strong>{{ job.function }}</strong> – Poste : {{ getPositionName(job.position_id) }}
      <button (click)="startEdit(job)">Modifier</button>
      <button (click)="deleteJob(job.job_id)">Supprimer</button>
    </div>

    <form *ngIf="editingId === job.job_id" [formGroup]="editForm" (ngSubmit)="saveEdit(job)">
      <input formControlName="function" placeholder="Fonction" />
      <select formControlName="position_id">
        <option *ngFor="let pos of positions" [value]="pos.position_id">
          {{ pos.name }}
        </option>
      </select>
      <button type="submit">Valider</button>
      <button type="button" (click)="cancelEdit()">Annuler</button>
    </form>
  </li>
</ul>
